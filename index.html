<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>邢鹏飞的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="邢鹏飞的博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="邢鹏飞的博客">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="邢鹏飞的博客">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="邢鹏飞的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://o6szdc7js.bkt.clouddn.com/blog_profile_new.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Pengfei Xing</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">文章</a></li>
				        
							<li><a href="/tags/Mobile">移动开发</a></li>
				        
							<li><a href="/tags/FullStack">全栈</a></li>
				        
							<li><a href="/tags/System">系统</a></li>
				        
							<li><a href="/tags/algorithm">算法</a></li>
				        
							<li><a href="/tags/Diary">随笔</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/novelidea" title="github">github</a>
					        
								<a class="linkedin" target="_blank" href="https://www.linkedin.com/in/pengfei-xing-65886578" title="linkedin">linkedin</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Algorithm/" style="font-size: 16.67px;">Algorithm</a> <a href="/tags/Android/" style="font-size: 11.67px;">Android</a> <a href="/tags/Backend/" style="font-size: 13.33px;">Backend</a> <a href="/tags/Cheet-Sheet/" style="font-size: 10px;">Cheet Sheet</a> <a href="/tags/Diary/" style="font-size: 13.33px;">Diary</a> <a href="/tags/FullStack/" style="font-size: 15px;">FullStack</a> <a href="/tags/Game/" style="font-size: 10px;">Game</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/IOS/" style="font-size: 18.33px;">IOS</a> <a href="/tags/Java/" style="font-size: 11.67px;">Java</a> <a href="/tags/Mobile/" style="font-size: 20px;">Mobile</a> <a href="/tags/MongoDB/" style="font-size: 10px;">MongoDB</a> <a href="/tags/OOD/" style="font-size: 10px;">OOD</a> <a href="/tags/RESTful/" style="font-size: 10px;">RESTful</a> <a href="/tags/Scrappy/" style="font-size: 10px;">Scrappy</a> <a href="/tags/SpriteKit/" style="font-size: 11.67px;">SpriteKit</a> <a href="/tags/System/" style="font-size: 10px;">System</a> <a href="/tags/Unity/" style="font-size: 10px;">Unity</a> <a href="/tags/WatchOS/" style="font-size: 10px;">WatchOS</a> <a href="/tags/系统/" style="font-size: 10px;">系统</a>
					</div>
				</section>
				
				
				

				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Pengfei Xing</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://o6szdc7js.bkt.clouddn.com/blog_profile_new.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">Pengfei Xing</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">文章</a></li>
		        
					<li><a href="/tags/Mobile">移动开发</a></li>
		        
					<li><a href="/tags/FullStack">全栈</a></li>
		        
					<li><a href="/tags/System">系统</a></li>
		        
					<li><a href="/tags/algorithm">算法</a></li>
		        
					<li><a href="/tags/Diary">随笔</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/novelidea" title="github">github</a>
			        
						<a class="linkedin" target="_blank" href="https://www.linkedin.com/in/pengfei-xing-65886578" title="linkedin">linkedin</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-类Sweep-Line问题分析" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/22/类Sweep-Line问题分析/" class="article-date">
  	<time datetime="2016-09-22T20:44:23.000Z" itemprop="datePublished">2016-09-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/22/类Sweep-Line问题分析/">类Sweep Line问题分析</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>最近发现了一种非常有意思的算法，叫做Sweep Line，但是该算法问题界定的范围不像DP, Greedy那么明确，所以暂称类Sweep Line问题吧。下面就通过实际问题来阐述。</p>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><h4 id="最长递增子序列问题"><a href="#最长递增子序列问题" class="headerlink" title="最长递增子序列问题"></a>最长递增子序列问题</h4><p>该问题的描述如下：<br>给定一个未排序的序列，找到其中最长的递增子序列，可以不连续。一般该问题可以用 DP 来解决，代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == nums || <span class="number">1</span> &gt; nums.length) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> len = nums.length;</span><br><span class="line">        <span class="keyword">int</span>[] opt = <span class="keyword">new</span> <span class="keyword">int</span>[len];</span><br><span class="line">        Arrays.fill(opt, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; i ++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j ++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (nums[i] &gt; nums[j]) &#123;</span><br><span class="line">                    opt[i] = Math.max(opt[i], opt[j] + <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            result = Math.max(result, opt[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该 DP 算法的时间复杂度为<code>O(n^2)</code>。这是大部分算法学习者都可以达到的正常水平，但是在这之外，我无意中发现有人用开挂技能来KO这道题，这就是文章一开始说的 Sweep Line 算法，而该算法可以达到<code>O(nlog(n))</code>的时间复杂度。代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span>[] result = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length];</span><br><span class="line">    <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x : nums) &#123;</span><br><span class="line">    	<span class="keyword">int</span> i = <span class="number">0</span>, j = size;</span><br><span class="line">       	<span class="keyword">while</span> (i != j) &#123;</span><br><span class="line">        	<span class="keyword">int</span> m = (i + j) / <span class="number">2</span>;</span><br><span class="line">           	<span class="keyword">if</span> (result[m] &lt; x)</span><br><span class="line">            	i = m + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            	j = m;</span><br><span class="line">        &#125;</span><br><span class="line">       	result[i] = x;</span><br><span class="line">        <span class="keyword">if</span> (i == size) ++size;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>该算法主要是维护了一个已经访问过的最长的递增序列，当新的数来临时，找到序列中第一个比该数大的数进行替换，如果都比该数小，则将该数放到递增子序列的末尾，递增子序列长度加一。所以外层遍历时间复杂度是<code>O(n)</code>,而由于递增子序列已经递增有序，所以找到第一个比该数大的数可以用二分查找，时间复杂度是 <code>O(log(n))</code>。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/">Algorithm</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Java中的比较器重写" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/20/Java中的比较器重写/" class="article-date">
  	<time datetime="2016-09-20T21:04:59.000Z" itemprop="datePublished">2016-09-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/20/Java中的比较器重写/">Java中的比较器重写</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><p>Java中经常会遇到重写比较器的情况，比如给某个自定义类根据一个属性的值进行排序，今天看到一个非常经典的数据结构设计的问题，不仅问题设计很好，中间居然还会重写两种比较器（因为之前接触的都是单独出现的），不禁拍案叫绝！</p>
<p>问题是要求设计一个简化版Twitter的数据结构，能够支持post, follow, unfollow几种操作，具体要求如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. postTweet(userId, tweetId): Compose a new tweet.</span><br><span class="line">2. getNewsFeed(userId): Retrieve the 10 most recent tweet ids in the user&apos;s news feed. Each item in the news feed must be posted by users who the user followed or by the user herself. Tweets must be ordered from most recent to least recent.</span><br><span class="line">3. follow(followerId, followeeId): Follower follows a followee.</span><br><span class="line">4. unfollow(followerId, followeeId): Follower unfollows a followee.</span><br></pre></td></tr></table></figure>
<h3 id="分析思路"><a href="#分析思路" class="headerlink" title="分析思路"></a>分析思路</h3><p>首先，需要为该系统引入两个HashMap。第一个Map是<code>&lt;User, List&lt;User&gt;&gt;</code>，主要用来记录某个用户关注的用户列表；第二个Map是<code>&lt;User, List&lt;Twitter&gt;&gt;</code>，主要用来记录某个用户发送的所有微博。</p>
<p>功能1只需要修改第二个Map，比较easy;<br>功能3，4只需要修改第一个Map；<br>功能三需要通过建立小顶堆来实现，较前几个功能稍显复杂。</p>
<p>正如开头所说，代码中比较有意思的是两种比较器的重写。第一种是给自定义类写比较器，比如在后续代码中需要用到该类的比较、排序等等。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">A</span>&gt; </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> val;</span><br><span class="line">	&lt;!--do something here--&gt;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(A other)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.val - other.val; &lt;!--Increasing Order--&gt;</span><br><span class="line">		<span class="keyword">return</span> other.val - <span class="keyword">this</span>.val; &lt;!--Decreasing Order--&gt;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>第二种是在容器的sort方法中重写。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A[] arr = <span class="keyword">new</span> A[<span class="number">10</span>];</span><br><span class="line">Collections.sort(A, <span class="keyword">new</span> Comparator&lt;A&gt;()&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(A a, A b)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> a.val - b.val; &lt;!--Increasing Order--&gt;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Twitter</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TContent</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">TContent</span>&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> id;</span><br><span class="line">        <span class="keyword">int</span> tweetId;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TContent</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> tweetId)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.id = id;</span><br><span class="line">            <span class="keyword">this</span>.tweetId = tweetId;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(TContent other)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.id - other.id;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    Map&lt;Integer, Set&lt;Integer&gt;&gt; follow;</span><br><span class="line">    Map&lt;Integer, List&lt;TContent&gt;&gt; tweet;</span><br><span class="line">    <span class="comment">/** Initialize your data structure here. */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Twitter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        follow = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        tweet = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        id = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/** Compose a new tweet. */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postTweet</span><span class="params">(<span class="keyword">int</span> userId, <span class="keyword">int</span> tweetId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (! tweet.containsKey(userId)) tweet.put(userId, <span class="keyword">new</span> ArrayList&lt;TContent&gt;());</span><br><span class="line">        List&lt;TContent&gt; tweets = tweet.get(userId);</span><br><span class="line">        tweets.add(<span class="keyword">new</span> TContent(id ++, tweetId));</span><br><span class="line">        tweet.put(userId, tweets);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/** Retrieve the 10 most recent tweet ids in the user's news feed. Each item in the news feed must be posted by users who the user followed or by the user herself. Tweets must be ordered from most recent to least recent. */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">getNewsFeed</span><span class="params">(<span class="keyword">int</span> userId)</span> </span>&#123;</span><br><span class="line">        Set&lt;Integer&gt; users = follow.containsKey(userId) ? follow.get(userId) : <span class="keyword">new</span> HashSet&lt;Integer&gt;();</span><br><span class="line">        users.add(userId);</span><br><span class="line">        PriorityQueue&lt;TContent&gt; queue = <span class="keyword">new</span> PriorityQueue&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;Integer, List&lt;TContent&gt;&gt; e : tweet.entrySet()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (users.contains(e.getKey())) &#123;</span><br><span class="line">                List&lt;TContent&gt; ts = e.getValue();</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ts.size(); i ++) &#123;</span><br><span class="line">                    queue.add(ts.get(i));</span><br><span class="line">                    <span class="keyword">if</span> (queue.size() &gt; <span class="number">10</span>) queue.poll();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;TContent&gt; tmp = <span class="keyword">new</span> ArrayList&lt;TContent&gt;();</span><br><span class="line">        <span class="keyword">while</span> (! queue.isEmpty()) &#123;</span><br><span class="line">            tmp.add(queue.poll());</span><br><span class="line">        &#125;</span><br><span class="line">        Collections.sort(tmp, <span class="keyword">new</span> Comparator&lt;TContent&gt;() &#123;</span><br><span class="line">           <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(TContent a, TContent b)</span> </span>&#123;</span><br><span class="line">               <span class="keyword">return</span> b.id - a.id;</span><br><span class="line">           &#125; </span><br><span class="line">        &#125;);</span><br><span class="line">        List&lt;Integer&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tmp.size(); i ++) &#123;</span><br><span class="line">            result.add(tmp.get(i).tweetId);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/** Follower follows a followee. If the operation is invalid, it should be a no-op. */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">follow</span><span class="params">(<span class="keyword">int</span> followerId, <span class="keyword">int</span> followeeId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (! follow.containsKey(followerId)) follow.put(followerId, <span class="keyword">new</span> HashSet&lt;Integer&gt;());</span><br><span class="line">        Set&lt;Integer&gt; followees = follow.get(followerId);</span><br><span class="line">        followees.add(followeeId);</span><br><span class="line">        follow.put(followerId, followees);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/** Follower unfollows a followee. If the operation is invalid, it should be a no-op. */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unfollow</span><span class="params">(<span class="keyword">int</span> followerId, <span class="keyword">int</span> followeeId)</span> </span>&#123;</span><br><span class="line">        Set&lt;Integer&gt; followees = follow.get(followerId);</span><br><span class="line">        <span class="keyword">if</span> (followees == <span class="keyword">null</span> || !followees.contains(followeeId)) <span class="keyword">return</span>;</span><br><span class="line">        followees.remove(followeeId);</span><br><span class="line">        follow.put(followerId, followees);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/">Algorithm</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-LOLls" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/13/LOLls/" class="article-date">
  	<time datetime="2016-09-13T22:15:01.000Z" itemprop="datePublished">2016-09-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/13/LOLls/">LOL！！！</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>［本文长期更新］<br>接触LOL时间不长，但是对里面的英雄人物比较感兴趣，所以就打算用一篇文章来总结自己玩过的英雄，不仅仅是技能，还有英雄背后的故事。本文将会长期更新（因为游戏会一直玩）。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Diary/">Diary</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-英语俚语" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/31/英语俚语/" class="article-date">
  	<time datetime="2016-08-01T04:27:18.000Z" itemprop="datePublished">2016-07-31</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/31/英语俚语/">英语俚语</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li>I’m on the fence</li>
<li>You’re the dogface</li>
<li>get laid with a girl</li>
<li>you’re insolvent</li>
<li>you’re broke</li>
<li>it’s none of my business</li>
<li>knock yourself out</li>
<li>really is a small world</li>
<li>gather faster please</li>
<li>Little more about me</li>
<li>It’s completely crap </li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Diary/">Diary</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Terminal-Command-Cheat-Sheet" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/09/Terminal-Command-Cheat-Sheet/" class="article-date">
  	<time datetime="2016-07-09T19:49:27.000Z" itemprop="datePublished">2016-07-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/09/Terminal-Command-Cheat-Sheet/">Terminal Command Cheat Sheet</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Hexo-Blog"><a href="#Hexo-Blog" class="headerlink" title="Hexo Blog"></a>Hexo Blog</h2><h3 id="generate-blog-site"><a href="#generate-blog-site" class="headerlink" title="generate blog site"></a>generate blog site</h3><p>hexo generate</p>
<h3 id="deploy-blog-on-local-server"><a href="#deploy-blog-on-local-server" class="headerlink" title="deploy blog on local server"></a>deploy blog on local server</h3><p>hexo server</p>
<h3 id="deploy-to-github"><a href="#deploy-to-github" class="headerlink" title="deploy to github"></a>deploy to github</h3><p>hexo deploy</p>
<h2 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h2><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><h3 id="check-thread-id-using-port-number"><a href="#check-thread-id-using-port-number" class="headerlink" title="check thread id using port #number"></a>check thread id using port #number</h3><p>lsof -i :number</p>
<h3 id="kill-process-by-PID"><a href="#kill-process-by-PID" class="headerlink" title="kill process by PID"></a>kill process by PID</h3><p>kill -9 [pid]</p>
<h2 id="VIM"><a href="#VIM" class="headerlink" title="VIM"></a>VIM</h2><h3 id="vertically-split-a-file"><a href="#vertically-split-a-file" class="headerlink" title="vertically split a file"></a>vertically split a file</h3><p>:vsp filename or :vs filename</p>
<h3 id="horizontallly-split-a-file"><a href="#horizontallly-split-a-file" class="headerlink" title="horizontallly split a file"></a>horizontallly split a file</h3><p>:sp filename</p>
<h3 id="move-cursor-between-multiple-windows"><a href="#move-cursor-between-multiple-windows" class="headerlink" title="move cursor between multiple windows"></a>move cursor between multiple windows</h3><p>ctr-w direction-key</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cheet-Sheet/">Cheet Sheet</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/FullStack/">FullStack</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Android事件处理" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/13/Android事件处理/" class="article-date">
  	<time datetime="2016-05-13T18:24:44.000Z" itemprop="datePublished">2016-05-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/13/Android事件处理/">Android事件处理</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Button事件处理"><a href="#Button事件处理" class="headerlink" title="Button事件处理"></a>Button事件处理</h2><p>安卓中给Button添加事件处理主要有两种方法。第一种方法是直接在layout中添加button时注册时间处理方法，然后再去java文件中实现该方法；第二种方法是在java文件中通过id获取该button，然后直接添加监听事件方法。</p>
<h3 id="layout文件中注册时间处理方法"><a href="#layout文件中注册时间处理方法" class="headerlink" title="layout文件中注册时间处理方法"></a>layout文件中注册时间处理方法</h3><p>首先在layout文件中添加button的时候加上时间处理方法名。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Button</span><br><span class="line">        android:id=<span class="string">"@+id/button"</span></span><br><span class="line">        ...</span><br><span class="line">        android:onClick=<span class="string">"buttonClickHandler"</span>/&gt;</span><br></pre></td></tr></table></figure></p>
<p>然后鼠标放在该注册方法上，按住<code>opt</code> + <code>Enter</code>，弹出需要实现该方法的java文件列表（如果工程中只有一个java文件，则默认该文件），最后在选定的目标文件中实现该方法。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buttonClickHandler</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        EditText et = (EditText) findViewById(R.id.nameText);</span><br><span class="line">        String name = et.getText().toString();</span><br><span class="line">        Snackbar.make(coordinatorLayout,</span><br><span class="line">                <span class="string">"Your name is: "</span> + name, Snackbar.LENGTH_LONG)</span><br><span class="line">                .setAction(<span class="string">"Action"</span>, <span class="keyword">null</span>).show();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="直接给按钮添加事件处理方法"><a href="#直接给按钮添加事件处理方法" class="headerlink" title="直接给按钮添加事件处理方法"></a>直接给按钮添加事件处理方法</h3><p>该方法直接通过id获取按钮，然后给按钮添加监听事件方法。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Button button = (Button) findViewById(R.id.SubmitButton);</span><br><span class="line">        button.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">                EditText et = (EditText) findViewById(R.id.nameText);</span><br><span class="line">                String entry = et.getText().toString();</span><br><span class="line">                Snackbar.make(v, <span class="string">"You entered: "</span> + entry, Snackbar.LENGTH_LONG)</span><br><span class="line">                        .setAction(<span class="string">"Action"</span>, <span class="keyword">null</span>).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mobile/">Mobile</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Android笔记" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/12/Android笔记/" class="article-date">
  	<time datetime="2016-05-12T18:12:42.000Z" itemprop="datePublished">2016-05-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/12/Android笔记/">Android笔记</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Android-Studio快捷方式"><a href="#Android-Studio快捷方式" class="headerlink" title="Android Studio快捷方式"></a>Android Studio快捷方式</h2><h3 id="reformate-code-in-order-to-make-it-easier-to-read"><a href="#reformate-code-in-order-to-make-it-easier-to-read" class="headerlink" title="reformate code in order to make it easier to read"></a>reformate code in order to make it easier to read</h3><p><code>Mac</code>: cmd + opt + l<br><code>Win</code>: ctr + alt + l</p>
<h3 id="find-file-in-the-entire-project"><a href="#find-file-in-the-entire-project" class="headerlink" title="find file in the entire project"></a>find file in the entire project</h3><p>double click <code>shift</code></p>
<h3 id="自动纠错"><a href="#自动纠错" class="headerlink" title="自动纠错"></a>自动纠错</h3><p>opt + Enter</p>
<h3 id="Refactor"><a href="#Refactor" class="headerlink" title="Refactor"></a>Refactor</h3><p>ctl + shift + R</p>
<h3 id="自动补全"><a href="#自动补全" class="headerlink" title="自动补全"></a>自动补全</h3><p>ctl + space：如果选项唯一，则自动补全。<br>例子:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:src=<span class="string">"@drawable/logo"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="提取dimension-resource"><a href="#提取dimension-resource" class="headerlink" title="提取dimension resource"></a>提取dimension resource</h3><p>提取dimension resource目的相当于给数字创建全局变量，方便以后修改。方法是鼠标定位到该行，然后按住<code>opt</code> + <code>Enter</code>即可。</p>
<h2 id="Android-Project理解"><a href="#Android-Project理解" class="headerlink" title="Android Project理解"></a>Android Project理解</h2><ol>
<li><p>layout加载顺序<br>先是家在<code>xml</code>中的layout设置，然后再加载代码中的layout。</p>
</li>
<li><p>Debug方法<br>在logcat中过滤出AndroidRuntime日志。</p>
</li>
</ol>
<h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><h3 id="Toast"><a href="#Toast" class="headerlink" title="Toast"></a>Toast</h3><p>Android Studio中输入<code>Toast</code>，然后回车便可出线代码如下代码模板：<br>Toast.makeText(MainActivity.this, “”, Toast.LENGTH_SHORT).show();<br>Toast显示的内容不受程序生命周期影响，即使在toast持续时间范围内关闭程序，toast内容也会显示。</p>
<h3 id="布局参数"><a href="#布局参数" class="headerlink" title="布局参数"></a>布局参数</h3><h4 id="相对位置"><a href="#相对位置" class="headerlink" title="相对位置"></a>相对位置</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">android:layout_above=<span class="string">"@+id/photo"</span></span><br><span class="line">android:layout_below=<span class="string">"@+id/imageView"</span></span><br><span class="line">android:layout_alignParentBottom=<span class="string">"true"</span></span><br><span class="line">android:layout_centerHorizontal=<span class="string">"true"</span></span><br></pre></td></tr></table></figure>
<h3 id="图片展示"><a href="#图片展示" class="headerlink" title="图片展示"></a>图片展示</h3><h4 id="静态展示方法"><a href="#静态展示方法" class="headerlink" title="静态展示方法"></a>静态展示方法</h4><p>直接在layout文件定义ImageView时赋值。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;ImageView</span><br><span class="line">    ...</span><br><span class="line">	android:src=<span class="string">"@drawable/logo"</span> /&gt;</span><br></pre></td></tr></table></figure></p>
<h4 id="动态展示方法"><a href="#动态展示方法" class="headerlink" title="动态展示方法"></a>动态展示方法</h4><h5 id="根据图片在工程文件中的路径获取图片"><a href="#根据图片在工程文件中的路径获取图片" class="headerlink" title="根据图片在工程文件中的路径获取图片"></a>根据图片在工程文件中的路径获取图片</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ImageView iv = (ImageView) findViewById(R.id.photo);</span><br><span class="line">iv.setImageResource(R.drawable.jacket101);</span><br></pre></td></tr></table></figure>
<h5 id="根据图片名字获取图片"><a href="#根据图片名字获取图片" class="headerlink" title="根据图片名字获取图片"></a>根据图片名字获取图片</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ImageView iv = (ImageView) findViewById(R.id.photo);</span><br><span class="line">String imageName = <span class="string">"jacket101"</span>;</span><br><span class="line"><span class="keyword">int</span> res = getResources().getIdentifier(imageName, <span class="string">"drawable"</span>, getPackageName());</span><br><span class="line">iv.setImageResource(res);</span><br></pre></td></tr></table></figure>
<h5 id="通过asset来获取图片"><a href="#通过asset来获取图片" class="headerlink" title="通过asset来获取图片"></a>通过asset来获取图片</h5><p>添加asset方法：Android-&gt;app-&gt;File-&gt;New-&gt;Folder-&gt;Assets Folder。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	InputStream stream = getAssets().open(imageName + <span class="string">".png"</span>);</span><br><span class="line">    Drawable d = Drawable.createFromStream(stream, <span class="keyword">null</span>);</span><br><span class="line">    iv.setImageDrawable(d);</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">	e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mobile/">Mobile</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-IOS开发中的四大对象及程序启动过程混讲" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/07/IOS开发中的四大对象及程序启动过程混讲/" class="article-date">
  	<time datetime="2016-05-08T02:43:54.000Z" itemprop="datePublished">2016-05-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/07/IOS开发中的四大对象及程序启动过程混讲/">IOS开发中的四大对象及程序启动过程混讲</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>IOS中的四大对象即UIApplication, appDelegate, UIWindow, UIViewController，之所以和程序启动过程混讲，是因为程序启动和它们密不可分。<br>UIApplication对象是应用程序的象征，每个App只有一个该对象，即UIApplication是单例，且是IOS程序启动创建的第一个对象,可以通过如下方法获得该对象：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> application = <span class="type">UIApplication</span>.sharedApplication()</span><br></pre></td></tr></table></figure></p>
<p><strong>功能</strong>：可以进行一些应用级别的操作，比如：设置应用程序桌面图标上的消息数目提醒；设置联网指示器的可见性；设置状态栏等等。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">application.applicationIconBadgeNumber = <span class="number">12</span>;</span><br><span class="line">application.networkActivityIndicatorVisible = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure></p>
<p>以上是设置消息数目提醒和联网指示，设置状态栏稍显复杂，首先需要配置plist文件，添加View controller-based status bar，并且设置为NO，然后再用<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">application.statusBarHidden = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure></p>
<p>当然，传统设置状态栏的方法比较简单，通过当前控制器进行，如下设置就可以了。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">preferredStatusBarStyle</span><span class="params">()</span></span> -&gt; <span class="type">UIStatusBarStyle</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">UIStatusBarStyle</span>.<span class="type">LightContent</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">prefersStatusBarHidden</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>application还有其他的一些功能，比如从本程序跳转到safari打开网页，或者拨打电话、发邮件、短信等等。如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    UIButton* openBaidu = [[UIButton alloc] initWithFrame:CGRectMake(100, 100, 100, 100)];</span><br><span class="line">    [openBaidu addTarget:self action:@selector(openBaidu) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">    openBaidu.backgroundColor = [UIColor redColor];</span><br><span class="line">    [self.view addSubview:openBaidu];</span><br><span class="line">&#125;</span><br><span class="line">- (void)openBaidu &#123;</span><br><span class="line">// open web</span><br><span class="line">    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@&quot;https://google.com&quot;]];</span><br><span class="line">// call phone</span><br><span class="line">//    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@&quot;tel:10086&quot;]];</span><br><span class="line">// send message</span><br><span class="line">//    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@&quot;sms:10086&quot;]];</span><br><span class="line">// send email</span><br><span class="line">//    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@&quot;mailto:1072131128@qq.com&quot;]];</span><br><span class="line">// open other app</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>现在，基本上可以对UIApplication有个初步的认识了，那问题是，既然UIApplication是程序创建的第一个类，<strong>那么这个类是什么时候创建的呢？</strong>要解开这个问题，就必须去了解程序的启动原理。</p>
<p>点击app，程序启动，首先进入的是main函数，main函数直接执行UIApplicationMain函数，该函数定义如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UIKIT_EXTERN int UIApplicationMain(int argc, char *argv[], NSString * __nullable principalClassName, NSString * __nullable delegateClassName);</span><br></pre></td></tr></table></figure></p>
<p>前两个参数argc, argv可以忽略，不影响理解，第三个参数必须是UIApplication类或者其子类，工程默认为nil，这是代表默认为UIApplication，即自动创建UIApplication类（就在这里创建第一个UIApplication类）；第四个参数是要创建的delegate类的名字，即根据delegate class name创建一个代理类，将该代理类赋值给UIApplication中的delegate属性。在上面这些都完成后，就建立主运行循环(Main runloop)，进行事件处理，首先处理的事情是delegate的didFinishLaunchApplication方法。这个就是程序启动的基本原理。</p>
<p>讲完了UIApplication，现在来讲程序的代理，即appDelegate。所有移动操作系统都有一个致命的缺点：app很容易受到打扰，比如一个来电，或者不小心锁屏了，app都会进入后台，甚至被终止。这些需要设置appDelegate来处理。这里我假设读者都是有一定IOS开发经验的，我们可以模拟一下启动程序，点击home键回到桌面，再次启动程序，这三个过程，分别看看都调用了哪些代理函数。</p>
<p>程序启动:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions; </span><br><span class="line">- (void)applicationDidBecomeActive:(UIApplication *)application;</span><br></pre></td></tr></table></figure></p>
<p>回到home:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (void)applicationWillResignActive:(UIApplication *)application;</span><br><span class="line">- (void)applicationDidEnterBackground:(UIApplication *)application；</span><br></pre></td></tr></table></figure></p>
<p>再次回到程序：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (void)applicationWillEnterForeground:(UIApplication *)application;</span><br><span class="line">- (void)applicationDidBecomeActive:(UIApplication *)application；</span><br></pre></td></tr></table></figure></p>
<p>模拟完了这三个过程，并且track到了过程中先后调用的代理函数基本就可以对代理有个初步的认识了。</p>
<p>最后，我们来讲一下UIWindow和UIViewController。这里面的关系为：手机屏幕是一个screen，screen上放置UIWindow，然后各种view就放置在UIWidow上面，一层层累加。而UIViewController可以通过设置为window的rootViewController来达到控制监听事件的功能。</p>
<p>关于UIWindow一方面可以通过storyboard默认创建，然后程序会默认设置rootViewController和相应的view；另一方面也可以通过代码创建，在appDelegate中通过设置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];</span><br><span class="line">self.window.backgroundColor = [UIColor whiteColor];</span><br></pre></td></tr></table></figure></p>
<p>// window 设置为主窗口 并且可见<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[self.window makeKeyAndVisible];</span><br></pre></td></tr></table></figure></p>
<p>另外，把控制器vc的view显示到window上有两种方法。第一种是直接加view，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[self.window addSubview: vc.view];</span><br></pre></td></tr></table></figure></p>
<p>另外一种是加控制器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.window.rootViewController = vc;</span><br></pre></td></tr></table></figure></p>
<p>一般采用的都是后者。</p>
<p>PS:如果项目中包含main storyboard，则不需要再在appDelegate中alloc window，这是无用功。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/IOS/">IOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mobile/">Mobile</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-用户系统设计流程" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/20/用户系统设计流程/" class="article-date">
  	<time datetime="2016-04-21T00:54:30.000Z" itemprop="datePublished">2016-04-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/20/用户系统设计流程/">用户系统设计流程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/系统/">系统</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-SpriteKit项目总结（一）" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/16/SpriteKit项目总结（一）/" class="article-date">
  	<time datetime="2016-04-16T20:35:40.000Z" itemprop="datePublished">2016-04-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/16/SpriteKit项目总结（一）/">SpriteKit项目总结（一）</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-SpritKit基础概念"><a href="#1-SpritKit基础概念" class="headerlink" title="1. SpritKit基础概念"></a>1. SpritKit基础概念</h2><h3 id="0-0-position"><a href="#0-0-position" class="headerlink" title="(0,0) position"></a>(0,0) position</h3><p>SpriteKit中(0,0)是指屏幕左下角的点，不同于UIKit，是左上角的点。</p>
<h3 id="Anchor-point"><a href="#Anchor-point" class="headerlink" title="Anchor point"></a>Anchor point</h3><p>如果给SKView加上一个background图片，需要设定改background的position，这里有两种方法。</p>
<h4 id="直接设置position"><a href="#直接设置position" class="headerlink" title="直接设置position"></a>直接设置position</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> background = <span class="type">SKSpriteNode</span>(imageNamed: <span class="string">"background1"</span>)</span><br><span class="line">background.position = <span class="type">CGPoint</span>(x: size.width / <span class="number">2</span>, y: size.height / <span class="number">2</span>)</span><br><span class="line">addChild(background)</span><br></pre></td></tr></table></figure>
<h4 id="通过设置background的anchor-point"><a href="#通过设置background的anchor-point" class="headerlink" title="通过设置background的anchor point"></a>通过设置background的anchor point</h4><p>先将背景图片的anchor point从默认状态的中间(0.5, 0.5)修改为左下角(0,0)，然后在将background的position直接和view的零点重合<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> background = <span class="type">SKSpriteNode</span>(imageNamed: <span class="string">"background1"</span></span><br><span class="line">background.anchorPoint = <span class="type">CGPoint</span>.zero</span><br><span class="line">background.position = <span class="type">CGPoint</span>.zero</span><br><span class="line">addChild(background)</span><br></pre></td></tr></table></figure></p>
<h4 id="Rotate"><a href="#Rotate" class="headerlink" title="Rotate"></a>Rotate</h4><p>SpriteKit中的rotate都是以anchor point为参考点的，可通过以下方法旋转background<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">background.zRotation = <span class="type">CGFloat</span>(<span class="type">M_PI</span>) / <span class="number">8</span></span><br></pre></td></tr></table></figure></p>
<h4 id="Size"><a href="#Size" class="headerlink" title="Size"></a>Size</h4><p>获取对象大小<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mySize = background.size</span><br></pre></td></tr></table></figure></p>
<h4 id="ignoresSiblingOrder-和-zPosition"><a href="#ignoresSiblingOrder-和-zPosition" class="headerlink" title="ignoresSiblingOrder 和 zPosition"></a>ignoresSiblingOrder 和 zPosition</h4><p>这两个属性所有SKNode的一个可设置属性，其中<code>ignoresSiblingOrder</code>主要是用来判断是否管理node间的parent-children关系，如果该属性设置为true，则<code>zPosition</code>数值相同的node就在同一层，并且是比改数值小的node的children。<br>需要注意的是，如果不小心将background的<code>zPosition</code>和其中的某个node（比如说一只小猫）的<code>zPosition</code>设置为相同的数值（比如说0），那么小猫有可能会被遮挡。所以，为了避免类似的bug产生，可以将永远在最高层（相对于屏幕来说就是最里面）的node的<code>zPosition</code>设置为－1。</p>
<h4 id="小结：添加sprite到scene的步骤"><a href="#小结：添加sprite到scene的步骤" class="headerlink" title="小结：添加sprite到scene的步骤"></a>小结：添加sprite到scene的步骤</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 生成sprite;</span><br><span class="line">2. 设置position;</span><br><span class="line">3. 设置zPosition(可选)；</span><br><span class="line">4. 将该sprite添加到scene.</span><br></pre></td></tr></table></figure>
<h2 id="2-Manual-Movement"><a href="#2-Manual-Movement" class="headerlink" title="2. Manual Movement"></a>2. Manual Movement</h2><h3 id="FPS"><a href="#FPS" class="headerlink" title="FPS"></a>FPS</h3><p><code>frame（帧）</code>:每张独立的图片。<br>一般在游戏中，为了使动画看起来平滑连贯，需要每秒播放30 － 60 张图片（frame），这个数值被称为<code>frame rate</code>，又叫做<code>frames per second(FPS)</code>。在用SpriteKit开放过程中，改值默认显示在屏幕的右下角。可以通过如下方法移除改显示<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">skView.showsFPS = <span class="literal">false</span></span><br><span class="line">skView.showsNodeCount = <span class="literal">false</span></span><br></pre></td></tr></table></figure></p>
<h3 id="update性能优化"><a href="#update性能优化" class="headerlink" title="update性能优化"></a>update性能优化</h3><p>SpriteKit通过<code>update</code>函数来更新frame，一般来说，<code>FPS</code>的极限最大值是60，也就是说大概每16毫秒update一次。但是，在一些情况下<code>update</code>函数可能过于冗长，或者硬件性能达不到<code>FPS</code>的数值，那<code>FPS</code>就会变小，这种情况是我们所不愿意看到的。所以，优秀的程序员会在实现功能的同时对代码运行时候的性能做出优化，主要可以从以下两个方面着手：</p>
<ol>
<li><code>优化update函数</code>:尽可能减小update函数的负担，将不必要的处理移除改函数，比如一些算法；</li>
<li><code>减小node数目</code>：当一些node不再使用时，将这些node移出scene。</li>
</ol>
<h3 id="Movement优化"><a href="#Movement优化" class="headerlink" title="Movement优化"></a>Movement优化</h3><p>之前提到Sprite可以每<code>16ms</code>更新一次frame，但是，由于硬件的不稳定性，这个更新间隔五法精准控制，这种不稳定性可以通过以下代码来跟踪。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> zombie = <span class="type">SKSpriteNode</span>(imageNamed: <span class="string">"zombie1"</span>)</span><br><span class="line"><span class="keyword">var</span> lastUpdateTime : <span class="type">NSTimeInterval</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">var</span> dt : <span class="type">NSTimeInterval</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">update</span><span class="params">(currentTime: NSTimeInterval)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> lastUpdateTime &gt; <span class="number">0</span> &#123;</span><br><span class="line">    	dt = currentTime - lastUpdateTime</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    	dt = <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(dt * 1000) milliseconds since last update"</span>)</span><br><span class="line">    lastUpdateTime = currentTime</span><br><span class="line">	zombie.position = <span class="type">CGPoint</span>(x: zombie.position.x + <span class="number">8</span>, y: zombie.position.y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这种更新频率的波动带来的后果就是视觉效果的不稳定性。为了解决改问题，我们可以将<code>更新间隔 ＊ 速率</code>作为物体在该update时间段内移动的距离。代码如下：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> zombieMovePointsPerSec : <span class="type">CGFloat</span> = <span class="number">480.0</span></span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">update</span><span class="params">(currentTime: NSTimeInterval)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> lastUpdateTime &gt; <span class="number">0</span> &#123;</span><br><span class="line">    	dt = currentTime - lastUpdateTime</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    	dt = <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    lastUpdateTime = currentTime</span><br><span class="line">    moveSprite(zombie, velocity: <span class="type">CGPoint</span>(x: zombieMovePointsPerSec, y: <span class="number">0</span>))</span><br><span class="line">&#125;    </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">moveSprite</span><span class="params">(sprite: SKSpriteNode, velocity: CGPoint)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> amountToMove = <span class="type">CGPoint</span>(</span><br><span class="line">    	x: velocity.x * <span class="type">CGFloat</span>(dt),</span><br><span class="line">        y: velocity.y * <span class="type">CGFloat</span>(dt))    </span><br><span class="line">   	sprite.position = <span class="type">CGPoint</span>(</span><br><span class="line">        x: sprite.position.x + amountToMove.x,</span><br><span class="line">        y: sprite.position.y + amountToMove.y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="处理点击事件"><a href="#处理点击事件" class="headerlink" title="处理点击事件"></a>处理点击事件</h3><p>控制点击事件的参数是<code>userInteractionEnabled</code>，该参数默认是<code>true</code>。为了实现点击，只需要重写<code>touchesBegan(withEvent:)</code>和<code>touchesMoved(withEvent:)</code>函数，<code>touchesEnded(withEvent:)</code>的实现为可选项。</p>
<h3 id="边界检测（Bounds-Checking）"><a href="#边界检测（Bounds-Checking）" class="headerlink" title="边界检测（Bounds Checking）"></a>边界检测（Bounds Checking）</h3><p>为了防止游戏界面中的物体运动出屏幕，需要进行边界检测，可以如下实现：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">boundsCheckZombie</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">let</span> bottomLeft = <span class="type">CGPointZero</span></span><br><span class="line">    <span class="keyword">let</span> topRight = <span class="type">CGPoint</span>(x: size.width, y: size.height)    </span><br><span class="line">    <span class="keyword">if</span> (zombie.position.x - zombie.size.width / <span class="number">2</span>) &lt;= bottomLeft.x &#123;</span><br><span class="line">    	zombie.position.x = bottomLeft.x + zombie.size.width / <span class="number">2</span></span><br><span class="line">        velocity.x = -velocity.x</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (zombie.position.x + zombie.size.width / <span class="number">2</span>) &gt;= topRight.x &#123;</span><br><span class="line">        zombie.position.x = topRight.x - zombie.size.width / <span class="number">2</span></span><br><span class="line">        velocity.x = -velocity.x</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (zombie.position.y - zombie.size.height / <span class="number">2</span>) &lt;= bottomLeft.y &#123;</span><br><span class="line">        zombie.position.y = bottomLeft.y + zombie.size.height / <span class="number">2</span></span><br><span class="line">        velocity.y = -velocity.y</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (zombie.position.y + zombie.size.height / <span class="number">2</span>) &gt;= topRight.y &#123;</span><br><span class="line">        zombie.position.y = topRight.y - zombie.size.height / <span class="number">2</span></span><br><span class="line">        velocity.y = -velocity.y</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里需要注意的是，由于物体（比如叫做zombie）的anchor point为中心点，所以判断的时候需要考虑到zombie的自身高度和宽度。<br>仍然存在的问题是：当游戏自适应iPhone和iPad时，iPhone的background会有一些background在屏幕外，所以即使有边界检测，物体仍然会运动出屏幕一小段距离，该如何优雅地解决改bug？</p>
<h4 id="iPhone上边界检测问题解决方法"><a href="#iPhone上边界检测问题解决方法" class="headerlink" title="iPhone上边界检测问题解决方法"></a>iPhone上边界检测问题解决方法</h4><p>在上面提到了边界检测中，由于要自适应iPhone和iPad，所以物体会运动出iPhone屏幕一段距离，解决方法是党运行在iPhone上时，给游戏区域加一个边界，及用一个CGRect类型的属性来存储改游戏区域，而不是直接读取background来获取游戏区域，实现方法如下：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> playableRect : <span class="type">CGRect</span></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">init</span>(size: <span class="type">CGSize</span>) &#123;</span><br><span class="line">	<span class="keyword">let</span> maxAspectRatio: <span class="type">CGFloat</span> = <span class="number">16.0</span> / <span class="number">9.0</span></span><br><span class="line">    <span class="keyword">let</span> playableHeight = size.width / maxAspectRatio</span><br><span class="line">    <span class="keyword">let</span> playableMargin = (size.height - playableHeight) / <span class="number">2.0</span></span><br><span class="line">    playableRect = <span class="type">CGRect</span>(x: <span class="number">0</span>, y: playableMargin, width: size.width, height: playableHeight)</span><br><span class="line">    <span class="keyword">super</span>.<span class="keyword">init</span>(size:size)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">    <span class="built_in">fatalError</span>(<span class="string">"init(coder:) has not been implemented"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">boundsCheckZombie</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> bottomLeft = <span class="type">CGPoint</span>(x: <span class="number">0</span>, y: <span class="type">CGRectGetMinY</span>(playableRect))</span><br><span class="line">    <span class="keyword">let</span> topRight = <span class="type">CGPoint</span>(x: size.width, y: <span class="type">CGRectGetMaxY</span>(playableRect))</span><br><span class="line">	……</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在debug改功能的时候，可以给改区域加个颜色高亮，实现方法如下：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">debugDrawPlayableArea</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">let</span> shape = <span class="type">SKShapeNode</span>()</span><br><span class="line">    <span class="keyword">let</span> path = <span class="type">CGPathCreateMutable</span>()</span><br><span class="line">    <span class="type">CGPathAddRect</span>(path, <span class="literal">nil</span>, playableRect)</span><br><span class="line">    shape.path = path</span><br><span class="line">    shape.strokeColor = <span class="type">SKColor</span>.redColor()</span><br><span class="line">    shape.lineWidth = <span class="number">4.0</span></span><br><span class="line">    addChild(shape)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="旋转"><a href="#旋转" class="headerlink" title="旋转"></a>旋转</h3><p>对于一些需要旋转的SKSpriteNode，比如一个人物要永远面向自己前进的方向，可以通过设置该SKSpriteNode的<code>zRotation</code>属性来实现。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">rotateSprite</span><span class="params">(sprite: SKSpriteNode, direction: CGPoint)</span></span> &#123;</span><br><span class="line">	sprite.zRotation = <span class="type">CGFloat</span>(atan2(<span class="type">Double</span>(direction.y), <span class="type">Double</span>(direction.x)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="node移动到指定点击点"><a href="#node移动到指定点击点" class="headerlink" title="node移动到指定点击点"></a>node移动到指定点击点</h3><p>实现方法是记录上一次的点击点位置，然后在<code>update</code>函数中算出当前点和目标点的距离，如果小于特定值（可以取每次update改变的值），就停止移动。下面是获取上一次点击位置坐标点方法：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lastTouchLocation: <span class="type">CGPoint</span>?</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sceneTouched</span><span class="params">(touchLocation:CGPoint)</span></span> &#123;</span><br><span class="line">	lastTouchLocation = touchLocation</span><br><span class="line">    moveZombieToward(touchLocation)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">touchesBegan</span><span class="params">(touches: Set&lt;UITouch&gt;,</span><br><span class="line">							withEvent event: UIEvent?)</span></span> &#123;</span><br><span class="line">	<span class="keyword">guard</span> <span class="keyword">let</span> touch = touches.first <span class="keyword">else</span> &#123;</span><br><span class="line">    	<span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> touchLocation = touch.locationInNode(<span class="keyword">self</span>)</span><br><span class="line">    sceneTouched(touchLocation)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">touchesMoved</span><span class="params">(touches: Set&lt;UITouch&gt;,</span><br><span class="line">                           withEvent event: UIEvent?)</span></span> &#123;</span><br><span class="line">	<span class="keyword">guard</span> <span class="keyword">let</span> touch = touches.first <span class="keyword">else</span> &#123;</span><br><span class="line">    	<span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> touchLocation = touch.locationInNode(<span class="keyword">self</span>)</span><br><span class="line">    sceneTouched(touchLocation)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>update</code>函数中进行判断。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> lastTouchLocation = lastTouchLocation &#123;</span><br><span class="line">	<span class="keyword">let</span> diff = lastTouchLocation - zombie.position</span><br><span class="line">    <span class="keyword">if</span> (diff.length() &lt;= zombieMovePointsPerSec * <span class="type">CGFloat</span>(dt)) &#123;</span><br><span class="line">    	zombie.position = lastTouchLocation</span><br><span class="line">        velocity = <span class="type">CGPointZero</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        moveSprite(zombie, velocity: velocity)</span><br><span class="line">       	rotateSprite(zombie, direction: velocity, </span><br><span class="line">       				rotateRadiansPerSec: zombieRotateRadiansPerSec)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-Action"><a href="#3-Action" class="headerlink" title="3. Action"></a>3. Action</h2><h3 id="Move-action"><a href="#Move-action" class="headerlink" title="Move action"></a>Move action</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> actionMidMove = <span class="type">SKAction</span>.moveTo(<span class="type">CGPoint</span>(x: size.width / <span class="number">2</span>, </span><br><span class="line">											y: <span class="type">CGRectGetMinY</span>(playableRect)), 									 duration: <span class="number">1.0</span>)</span><br><span class="line">enemy.runAction(actionMidMove)</span><br></pre></td></tr></table></figure>
<h3 id="Block-action"><a href="#Block-action" class="headerlink" title="Block action"></a>Block action</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> logMessage = <span class="type">SKAction</span>.runBlock() &#123;</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"Reach bottom!"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Wait-action"><a href="#Wait-action" class="headerlink" title="Wait action"></a>Wait action</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> wait = <span class="type">SKAction</span>.waitForDuration(<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Sequence-action"><a href="#Sequence-action" class="headerlink" title="Sequence action"></a>Sequence action</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> actionMidMove = <span class="type">SKAction</span>.moveTo(<span class="type">CGPoint</span>(x: size.width / <span class="number">2</span>, </span><br><span class="line">											 y: <span class="type">CGRectGetMinY</span>(playableRect)), 									 duration: <span class="number">1.0</span>)</span><br><span class="line"><span class="keyword">let</span> actionMove = <span class="type">SKAction</span>.moveTo(<span class="type">CGPoint</span>(x: -enemy.size.width / <span class="number">2</span>, </span><br><span class="line">										  y: enemy.position.y), </span><br><span class="line">										  duration: <span class="number">1.0</span>)</span><br><span class="line"><span class="keyword">let</span> sequence = <span class="type">SKAction</span>.sequence([actionMidMove, logMessage, wait, actionMove])</span><br><span class="line">enemy.runAction(sequence)</span><br></pre></td></tr></table></figure>
<h3 id="Reverse-action"><a href="#Reverse-action" class="headerlink" title="Reverse action"></a>Reverse action</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> reverseMid = actionMidMove.reversedAction()</span><br></pre></td></tr></table></figure>
<h3 id="Repeat-action"><a href="#Repeat-action" class="headerlink" title="Repeat action"></a>Repeat action</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> sequence = <span class="type">SKAction</span>.sequence([</span><br><span class="line">               actionMidMove, logMessage, wait, actionMove,</span><br><span class="line">               reverseMove, logMessage, wait, reverseMid</span><br><span class="line">])</span><br><span class="line"><span class="keyword">let</span> action = <span class="type">SKAction</span>.repeatActionForever(sequence)</span><br><span class="line">enemy.runAction(action)</span><br></pre></td></tr></table></figure>
<h3 id="Remove-node-from-parent"><a href="#Remove-node-from-parent" class="headerlink" title="Remove node from parent"></a>Remove node from parent</h3><p>正如之前<code>update性能优化</code>中所说，当一个node不再需要时，比如一个导弹从左移到右，直到移除屏幕范围，就需要将改node从parent中移除（这里考虑的时不断新建node，而不是重用node），可以通过以下方法实现：<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> actionMove = <span class="type">SKAction</span>.moveToX(-enemy.size.width/<span class="number">2</span>, duration: <span class="number">2.0</span>)</span><br><span class="line"><span class="keyword">let</span> actionRemove = <span class="type">SKAction</span>.removeFromParent()</span><br><span class="line">enemy.runAction(<span class="type">SKAction</span>.sequence([actionMove, actionRemove]))</span><br></pre></td></tr></table></figure></p>
<h3 id="Animation-Action"><a href="#Animation-Action" class="headerlink" title="Animation Action"></a>Animation Action</h3><p>可以通过一组图片来串联成动态图，模拟任务的动作。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> zombieAnimation: <span class="type">SKAction</span></span><br><span class="line"><span class="keyword">override</span> <span class="keyword">init</span>(size: <span class="type">CGSize</span>) &#123;        </span><br><span class="line">	<span class="keyword">var</span> textures: [<span class="type">SKTexture</span>] = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">4</span> &#123;</span><br><span class="line">    	textures.append(<span class="type">SKTexture</span>(imageNamed: <span class="string">"zombie\(i)"</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    textures.append(textures[<span class="number">2</span>])</span><br><span class="line">    textures.append(textures[<span class="number">1</span>])</span><br><span class="line">    zombieAnimation = <span class="type">SKAction</span>.animateWithTextures(textures,</span><br><span class="line">                                                   timePerFrame: <span class="number">0.1</span>)</span><br><span class="line">    ……</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Stop-Animation"><a href="#Stop-Animation" class="headerlink" title="Stop Animation"></a>Stop Animation</h3><p>主要实现功能是当任务走路时调用走动动画，当静止时就停止，主要用到的方法是<code>repeatActionForever</code>，<code>removeActionForKey</code>。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">startZombieAnimation</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> zombie.actionForKey(<span class="string">"animation"</span>) == <span class="literal">nil</span> &#123;</span><br><span class="line">    	zombie.runAction(</span><br><span class="line">        	<span class="type">SKAction</span>.repeatActionForever(zombieAnimation), withKey: <span class="string">"Animation"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;    </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">stopZombieAnimation</span><span class="params">()</span></span> &#123;</span><br><span class="line">	zombie.removeActionForKey(<span class="string">"Animation"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Scale"><a href="#Scale" class="headerlink" title="Scale"></a>Scale</h3><p>主要实现物体的缩放功能。<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">SKAction</span>.scaleTo(scale, duration)</span><br><span class="line"><span class="type">SKAction</span>.scaleXTo(scale, duration)</span><br><span class="line"><span class="type">SKAction</span>.scaleYTo(scale, duration)</span><br></pre></td></tr></table></figure></p>
<h3 id="Rotate-action"><a href="#Rotate-action" class="headerlink" title="Rotate action"></a>Rotate action</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat.zRotation = -π / <span class="number">16.0</span></span><br><span class="line"><span class="keyword">let</span> leftWiggle = <span class="type">SKAction</span>.rotateByAngle(π/<span class="number">8.0</span>, duration: <span class="number">0.5</span>)</span><br><span class="line"><span class="keyword">let</span> rightWiggle = leftWiggle.reversedAction()</span><br><span class="line"><span class="keyword">let</span> fullWiggle = <span class="type">SKAction</span>.sequence([leftWiggle, rightWiggle])</span><br><span class="line"><span class="keyword">let</span> wiggleWait = <span class="type">SKAction</span>.repeatAction(fullWiggle, <span class="built_in">count</span>: <span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Group-actions"><a href="#Group-actions" class="headerlink" title="Group actions"></a>Group actions</h3><p><code>group actions</code>主要是把几个action放在同一时间内执行，比如<code>scale</code>和<code>rotation</code>。具体步骤如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. 定义单个action；</span><br><span class="line">2. 多个action组成sequence；</span><br><span class="line">3. 将repeat action sequence转换成action;</span><br><span class="line">4. 将多个3中的action转换成sequence;</span><br><span class="line">5. group 4中的sequence;</span><br><span class="line">6. 将group sequence action转换成action;</span><br><span class="line">7. run 6中action.</span><br></pre></td></tr></table></figure></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> group = <span class="type">SKAction</span>.group([fullScale, fullWiggle])</span><br><span class="line"><span class="keyword">let</span> groupWait = <span class="type">SKAction</span>.repeatAction(group, <span class="built_in">count</span>: <span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<h3 id="优化碰撞检测"><a href="#优化碰撞检测" class="headerlink" title="优化碰撞检测"></a>优化碰撞检测</h3><p>碰撞检测应该重写<code>didEvaluateActions</code>函数中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">override func didEvaluateActions() &#123;</span><br><span class="line">	checkCollisions()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Sound"><a href="#Sound" class="headerlink" title="Sound"></a>Sound</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">runAction(SKAction.playSoundFileNamed(&quot;hitCat.wav&quot;,waitForCompletion: false))</span><br></pre></td></tr></table></figure>
<p>但是上述代码存在的问题是：当第一次加载音乐文件时后有延迟，所以正确的解决方法是将音乐文件提前加在，方法之一是将加载音乐播放音乐设置成一个SKAction类型属性。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let catCollisionSound: SKAction = SKAction.playSoundFileNamed(&quot;hitCat.wav&quot;,waitForCompletion: false)</span><br><span class="line">runAction(catCollisionSound)</span><br></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/IOS/">IOS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Mobile/">Mobile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpriteKit/">SpriteKit</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Pengfei Xing
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>